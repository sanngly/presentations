SELECT 
 A.BK_STATEMENT_OF_WORK_ID, 
 A.STATEMENT_OF_WORK_NAME,
 B.AP_VENDOR_NAME,
 B.PARENT_VENDOR_NAME,
 H.MANAGEMENT_HIERARCHY_NODE_NAME AS FUNDING_SUPERVISOR_NAME,
 H.DEPARTMENT_MANAGER_PARTY_KEY AS FUNDING_SUPERVISOR_KEY,
 I.NODE_LEVEL01_NAME AS LEVEL01_FUNDING_SUPERVISOR_NAME,
 I.NODE_LEVEL02_NAME AS LEVEL02_FUNDING_SUPERVISOR_NAME,
 I.NODE_LEVEL03_NAME AS LEVEL03_FUNDING_SUPERVISOR_NAME,
 I.NODE_LEVEL04_NAME AS LEVEL04_FUNDING_SUPERVISOR_NAME,
 I.NODE_LEVEL05_NAME AS LEVEL05_FUNDING_SUPERVISOR_NAME,
 I.NODE_LEVEL06_NAME AS LEVEL06_FUNDING_SUPERVISOR_NAME,
 I.NODE_LEVEL07_NAME AS LEVEL07_FUNDING_SUPERVISOR_NAME,
 I.NODE_LEVEL08_NAME AS LEVEL08_FUNDING_SUPERVISOR_NAME,
 C.DD_PRIMARY_NAME AS RESOURCE_SUPERVISOR_NAME, 
 C.CISCO_WORKER_PARTY_KEY AS RESOURCE_SUPERVISOR_PARTY_KEY ,
G.EMPLEVEL,
G.LEVEL1_SUPERVISOR_PARTY_KEY AS LEVEL01_RESOURCE_SUPERVISOR_PARTY_KEY,
G.LEVEL1_CISCO_WORKER_NAME AS LEVEL01_RESOURCE_SUPERVISOR_NAME,
G.LEVEL2_SUPERVISOR_PARTY_KEY AS LEVEL02_RESOURCE_SUPERVISOR_PARTY_KEY,
G.LEVEL2_CISCO_WORKER_NAME AS LEVEL02_RESOURCE_SUPERVISOR_NAME,
G.LEVEL3_SUPERVISOR_PARTY_KEY AS LEVEL03_RESOURCE_SUPERVISOR_PARTY_KEY,
G.LEVEL3_CISCO_WORKER_NAME AS LEVEL03_RESOURCE_SUPERVISOR_NAME,
G.LEVEL4_SUPERVISOR_PARTY_KEY AS LEVEL04_RESOURCE_SUPERVISOR_PARTY_KEY,
G.LEVEL4_CISCO_WORKER_NAME AS LEVEL04_RESOURCE_SUPERVISOR_NAME,
G.LEVEL5_SUPERVISOR_PARTY_KEY AS LEVEL05_RESOURCE_SUPERVISOR_PARTY_KEY,
G.LEVEL5_CISCO_WORKER_NAME AS LEVEL05_RESOURCE_SUPERVISOR_NAME,
G.LEVEL6_SUPERVISOR_PARTY_KEY AS LEVEL06_RESOURCE_SUPERVISOR_PARTY_KEY,
G.LEVEL6_CISCO_WORKER_NAME AS LEVEL06_RESOURCE_SUPERVISOR_NAME,
G.LEVEL7_SUPERVISOR_PARTY_KEY AS LEVEL07_RESOURCE_SUPERVISOR_PARTY_KEY,
G.LEVEL7_CISCO_WORKER_NAME AS LEVEL07_RESOURCE_SUPERVISOR_NAME,
G.LEVEL8_SUPERVISOR_PARTY_KEY AS LEVEL08_RESOURCE_SUPERVISOR_PARTY_KEY,
G.LEVEL8_CISCO_WORKER_NAME AS LEVEL08_RESOURCE_SUPERVISOR_NAME,
A.TRANSACTIONAL_CURRENCY_CD AS SOW_CURRENCY_CD,
A.MAXIMUM_BUDGET_AMT  AS TOTAL_BUDGET , 
 A.SPEND_TO_TRANSACTIONAL_DT_AMT AS TOTAL_SPEND,
 A.STATEMENT_OF_WORK_STATUS_CD AS SOW_STATUS,
 A.PURCHASE_ORDER_KEY   AS PO_KEY, 
 D.BK_PURCHASE_ORDER_NUM , 
 D.BK_PURCHASE_ORDER_CREATE_DT,
 D.PO_STATUS_CD,
 D.PO_APPROVAL_STATUS_CD,
 D.PO_APPROVAL_DTM,
 A.STATEMENT_OF_WORK_START_DT, 
 A.STATEMENT_OF_WORK_END_DT, 
 A.DEPARTMENT_CD , 
 E.BK_WORK_ORDER_ID,
 E.WORK_ORDER_TYPE,
 F.DD_PRIMARY_NAME AS RESOURCE_NAME,
 F.PUBLIC_JOB_TITLE AS JOB_TITLE, 
 J.LOCATION_DESCR , 
 J.CITY_NAME, 
 J.BK_STATE_CD, 
 J.BK_ISO_COUNTRY_CD 

FROM GPSPVWDB.PV_STMT_WORK_CNTGNT_WRKR A
LEFT OUTER JOIN GPSPVWDB.PV_ACCTS_PYBL_VNDR_PRTY B ON A.VENDOR_PARTY_KEY=B.AP_VENDOR_PARTY_KEY
LEFT OUTER JOIN GPSPVWDB.PV_CISCO_WORKER_PARTY C ON A.STATEMENT_WORK_OWNER_PARTY_KEY=C.CISCO_WORKER_PARTY_KEY
INNER JOIN HRVWDB.R_CISCO_WKR_SUPV_HIERARCHY_CUR G ON C.CISCO_WORKER_PARTY_KEY = G.CISCO_WORKER_PARTY_KEY
LEFT OUTER JOIN GPSPVWDB.PV_PURCHASE_ORDER D  ON A.PURCHASE_ORDER_KEY = D.PURCHASE_ORDER_KEY
LEFT OUTER JOIN GPSPVWDB.PV_CNTGNT_WRKR_WORK_ORD E ON E.RU_STATEMENT_OF_WORK_ID = A.BK_STATEMENT_OF_WORK_ID
INNER JOIN HRVWDB.N_CISCO_WORKER_PARTY F ON E.CISCO_CNTNGNT_WORKER_PARTY_KEY = F.CISCO_WORKER_PARTY_KEY -- (using HRVWDB.N_CISCO_WORKER_PARTY table instead of view GPSPVWDB.PV_CISCO_WORKER_PARTY to generate Location details as view table do not have HR_LOCATION_KEY attribute) 
LEFT OUTER JOIN GPSPVWDB.PV_FINANCIAL_DEPARTMENT H ON  H.BK_DEPARTMENT_CODE = A.DEPARTMENT_CD
INNER JOIN GPSPVWDB.PV_MT_MANAGEMENT_AH_HIERARCHY I ON I.FINANCIAL_DEPARTMENT_CODE = H.BK_DEPARTMENT_CODE
INNER JOIN GPSPVWDB.PV_HR_LOCATION J  ON J.HR_LOCATION_KEY = F.HR_LOCATION_KEY  

--where A.BK_STATEMENT_OF_WORK_ID='CSCOTQ00132195'


